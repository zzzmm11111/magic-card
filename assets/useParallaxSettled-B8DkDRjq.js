import{Z as D,_ as L,M as A,I as j,j as c,w as X,c as b,o as P,g as R}from"./index-H8hk9Xr0.js";function W(e){return D()?(L(e),!0):!1}function H(e){return typeof e=="function"?e():A(e)}const B=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const I=Object.prototype.toString,G=e=>I.call(e)==="[object Object]",V=()=>{},k=B?window:void 0;function _(e){var t;const a=H(e);return(t=a==null?void 0:a.$el)!=null?t:a}function y(...e){let t,a,n,u;if(typeof e[0]=="string"||Array.isArray(e[0])?([a,n,u]=e,t=k):[t,a,n,u]=e,!t)return V;Array.isArray(a)||(a=[a]),Array.isArray(n)||(n=[n]);const l=[],i=()=>{l.forEach(m=>m()),l.length=0},r=(m,v,d,p)=>(m.addEventListener(v,d,p),()=>m.removeEventListener(v,d,p)),f=X(()=>[_(t),H(u)],([m,v])=>{if(i(),!m)return;const d=G(v)?{...v}:v;l.push(...a.flatMap(p=>n.map(h=>r(m,p,h,d))))},{immediate:!0,flush:"post"}),g=()=>{f(),i()};return W(g),g}function F(){const e=c(!1),t=R();return t&&P(()=>{e.value=!0},t),e}function C(e){const t=F();return b(()=>(t.value,!!e()))}function N(e={}){const{window:t=k}=e,a=C(()=>t&&"DeviceOrientationEvent"in t),n=c(!1),u=c(null),l=c(null),i=c(null);return t&&a.value&&y(t,"deviceorientation",r=>{n.value=r.absolute,u.value=r.alpha,l.value=r.beta,i.value=r.gamma}),{isSupported:a,isAbsolute:n,alpha:u,beta:l,gamma:i}}const U={page:e=>[e.pageX,e.pageY],client:e=>[e.clientX,e.clientY],screen:e=>[e.screenX,e.screenY],movement:e=>e instanceof Touch?null:[e.movementX,e.movementY]};function Z(e={}){const{type:t="page",touch:a=!0,resetOnTouchEnds:n=!1,initialValue:u={x:0,y:0},window:l=k,target:i=l,scroll:r=!0,eventFilter:f}=e;let g=null,m=0,v=0;const d=c(u.x),p=c(u.y),h=c(null),w=typeof t=="function"?t:U[t],o=s=>{const Y=w(s);g=s,Y&&([d.value,p.value]=Y,h.value="mouse"),l&&(m=l.scrollX,v=l.scrollY)},O=s=>{if(s.touches.length>0){const Y=w(s.touches[0]);Y&&([d.value,p.value]=Y,h.value="touch")}},x=()=>{if(!g||!l)return;const s=w(g);g instanceof MouseEvent&&s&&(d.value=s[0]+l.scrollX-m,p.value=s[1]+l.scrollY-v)},M=()=>{d.value=u.x,p.value=u.y},S=f?s=>f(()=>o(s),{}):s=>o(s),E=f?s=>f(()=>O(s),{}):s=>O(s),T=f?()=>f(()=>x(),{}):()=>x();if(i){const s={passive:!0};y(i,["mousemove","dragover"],S,s),a&&t!=="movement"&&(y(i,["touchstart","touchmove"],E,s),n&&y(i,"touchend",M,s)),r&&t==="page"&&y(l,"scroll",T,{passive:!0})}return{x:d,y:p,sourceType:h}}function $(e,t={}){const{handleOutside:a=!0,window:n=k}=t,u=t.type||"page",{x:l,y:i,sourceType:r}=Z(t),f=c(e??(n==null?void 0:n.document.body)),g=c(0),m=c(0),v=c(0),d=c(0),p=c(0),h=c(0),w=c(!0);let o=()=>{};return n&&(o=X([f,l,i],()=>{const O=_(f);if(!O||!(O instanceof Element))return;const{left:x,top:M,width:S,height:E}=O.getBoundingClientRect();v.value=x+(u==="page"?n.pageXOffset:0),d.value=M+(u==="page"?n.pageYOffset:0),p.value=E,h.value=S;const T=l.value-v.value,s=i.value-d.value;w.value=S===0||E===0||T<0||s<0||T>S||s>E,(a||!w.value)&&(g.value=T,m.value=s)},{immediate:!0}),y(document,"mouseleave",()=>{w.value=!0})),{x:l,y:i,sourceType:r,elementX:g,elementY:m,elementPositionX:v,elementPositionY:d,elementHeight:p,elementWidth:h,isOutside:w,stop:o}}function q(e={}){const{window:t=k}=e,a=C(()=>t&&"screen"in t&&"orientation"in t.screen),n=a.value?t.screen.orientation:{},u=c(n.type),l=c(n.angle||0);return a.value&&y(t,"orientationchange",()=>{u.value=n.type,l.value=n.angle}),{isSupported:a,orientation:u,angle:l,lockOrientation:f=>a.value&&typeof n.lock=="function"?n.lock(f):Promise.reject(new Error("Not supported")),unlockOrientation:()=>{a.value&&typeof n.unlock=="function"&&n.unlock()}}}function z(e,t={}){const{deviceOrientationTiltAdjust:a=o=>o,deviceOrientationRollAdjust:n=o=>o,mouseTiltAdjust:u=o=>o,mouseRollAdjust:l=o=>o,window:i=k}=t,r=j(N({window:i})),f=j(q({window:i})),{elementX:g,elementY:m,elementWidth:v,elementHeight:d}=$(e,{handleOutside:!1,window:i}),p=b(()=>r.isSupported&&(r.alpha!=null&&r.alpha!==0||r.gamma!=null&&r.gamma!==0)?"deviceOrientation":"mouse"),h=b(()=>{if(p.value==="deviceOrientation"){let o;switch(f.orientation){case"landscape-primary":o=r.gamma/90;break;case"landscape-secondary":o=-r.gamma/90;break;case"portrait-primary":o=-r.beta/90;break;case"portrait-secondary":o=r.beta/90;break;default:o=-r.beta/90}return n(o)}else{const o=-(m.value-d.value/2)/d.value;return l(o)}}),w=b(()=>{if(p.value==="deviceOrientation"){let o;switch(f.orientation){case"landscape-primary":o=r.beta/90;break;case"landscape-secondary":o=-r.beta/90;break;case"portrait-primary":o=r.gamma/90;break;case"portrait-secondary":o=-r.gamma/90;break;default:o=r.gamma/90}return a(o)}else{const o=(g.value-v.value/2)/v.value;return u(o)}});return{roll:h,tilt:w,source:p}}const J=1600;function Q(e){const t=z(e),a=c(!1);let n=null;const u=X(()=>A(t.source),r=>{if(n&&(clearTimeout(n),n=null),r==="mouse"){a.value=!0;return}r==="deviceOrientation"&&(n=setTimeout(()=>{a.value=!0,n=null},J))},{immediate:!0});W(()=>{u(),n&&clearTimeout(n)});const l=b(()=>a.value?A(t.tilt):0),i=b(()=>a.value?A(t.roll):0);return{tilt:l,roll:i,source:t.source}}export{Q as u};
